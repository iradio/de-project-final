Спасибо за комментарии и предложения.
Вытащил формирование SQL из тела основной функции в обоих DAGах. Так конечно читабельнее стало.

Заодно внес правку в криетерии выборки транзакций, т.к. получил комментарий от предподавателя по постановке задачи.
Теперь при расчете global_metrics отбираются операции не имеющие транзакции со статусом 'chargeback' и соответствующие этим критериям
        		and transaction_day = '{execution_date}' -- выбираем только один день
                and account_number_from > 0 -- убираем тестовые аккаунты
                and account_number_to > 0 -- убираем тестовые аккаунты
                and t.status = 'done' -- оставляем только завершенные транзакции
                and t.transaction_type in ('c2a_incoming',
                                            'c2b_partner_incoming',
                                            'sbp_incoming',
                                            'sbp_outgoing',
                                            'transfer_incoming',
                                            'transfer_outgoing') 